"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Hotp = void 0;
class Hotp {
    constructor(args) {
        this.value = args.value;
        this.expiresIn = args.expiresIn;
        this.secret = args.secret;
        this.counter = args.counter;
        this.createdAt = new Date().getTime();
        this.verifyFn = args.verifyFn;
    }
    verify(code) {
        if (this.expiresIn && new Date().getTime() > this.createdAt + this.expiresIn) {
            return false;
        }
        return this.verifyFn(code, this.secret, this.counter);
    }
}
exports.Hotp = Hotp;
//# sourceMappingURL=hotp.js.map