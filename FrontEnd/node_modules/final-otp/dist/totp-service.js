"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Totp = void 0;
const hotp_service_1 = require("./hotp-service");
class Totp {
    constructor() {
        this.hotp = new hotp_service_1.Hotp();
    }
    create(secret, t1, t0 = 0, digits = 6) {
        if (!t1) {
            t1 = Math.round(new Date().getTime() / 1000);
        }
        const timeSteps = Math.floor((t1 - t0) / 30);
        return this.hotp.create(secret, timeSteps, digits);
    }
    verify(code, secret, t1, t0 = 0) {
        if (code.length < 6 || code.length > 8) {
            throw new Error('Undefined length of code.');
        }
        if (!t1) {
            t1 = Math.round(new Date().getTime() / 1000);
        }
        const comparisons = [
            this.create(secret, t1, t0, code.length),
            this.create(secret, t1 + 30, t0, code.length),
            this.create(secret, t1 + 60, t0, code.length)
        ];
        return comparisons.some(comparison => comparison === code);
    }
}
exports.Totp = Totp;
//# sourceMappingURL=totp-service.js.map