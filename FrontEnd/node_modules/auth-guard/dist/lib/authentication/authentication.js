"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Authentication = void 0;
var Authentication;
(function (Authentication) {
    function otpToUri(options) {
        var uri = "otpauth://" + options.type + "/" + options.issuer + ":" + options.to + "?secret=" + options.secret + "&issuer=" + options.issuer;
        if (options.digits) {
            uri += "&digits=" + options.digits;
        }
        if (options.period) {
            uri += "&period=" + options.period;
        }
        if (options.initialCounter) {
            uri += "&counter=" + options.initialCounter;
        }
        return uri;
    }
    Authentication.otpToUri = otpToUri;
    function uriToOtp(uri) {
        var uriStart = 'otpauth://';
        if (!uri || !uri.startsWith(uriStart)) {
            throw new Error('Wrong URI!');
        }
        var rawValues = uri.slice(uriStart.length);
        var type = rawValues.slice(0, rawValues.indexOf('/'));
        var to = rawValues.slice(rawValues.indexOf(':'), rawValues.indexOf('?'));
        var options = rawValues.slice(rawValues.indexOf('?') + 1).split('&');
        var otpValues = {
            type: type,
            to: to
        };
        for (var _i = 0, options_1 = options; _i < options_1.length; _i++) {
            var option = options_1[_i];
            var _a = option.split('='), key = _a[0], value = _a[1];
            otpValues[key] = value;
        }
        return otpValues;
    }
    Authentication.uriToOtp = uriToOtp;
})(Authentication = exports.Authentication || (exports.Authentication = {}));
