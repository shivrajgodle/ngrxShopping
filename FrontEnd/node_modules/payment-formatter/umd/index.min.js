!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.paymentFormatter=e()}(this,function(){"use strict";var t=/(\d{1,4})/g,e=[{type:"amex",format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,startPattern:/^3[47]/,maxCardNumberLength:15,cvcLength:4},{type:"dankort",format:t,startPattern:/^5019/,maxCardNumberLength:16,cvcLength:3},{type:"hipercard",format:t,startPattern:/^(384100|384140|384160|606282|637095|637568|60(?!11))/,maxCardNumberLength:19,cvcLength:3},{type:"dinersclub",format:t,startPattern:/^(36|38|30[0-5])/,maxCardNumberLength:14,cvcLength:3},{type:"discover",format:t,startPattern:/^(6011|65|64[4-9]|622)/,maxCardNumberLength:16,cvcLength:3},{type:"jcb",format:t,startPattern:/^35/,maxCardNumberLength:16,cvcLength:3},{type:"laser",format:t,startPattern:/^(6706|6771|6709)/,maxCardNumberLength:19,cvcLength:3},{type:"maestro",format:t,startPattern:/^(5018|5020|5038|6304|6703|6708|6759|676[1-3])/,maxCardNumberLength:19,cvcLength:3},{type:"mastercard",format:t,startPattern:/^(5[1-5]|677189)|^(222[1-9]|2[3-6]\d{2}|27[0-1]\d|2720)/,maxCardNumberLength:16,cvcLength:3},{type:"unionpay",format:t,startPattern:/^62/,maxCardNumberLength:19,cvcLength:3,luhn:!1},{type:"visaelectron",format:t,startPattern:/^4(026|17500|405|508|844|91[37])/,maxCardNumberLength:16,cvcLength:3},{type:"elo",format:t,startPattern:/^(4011(78|79)|43(1274|8935)|45(1416|7393|763(1|2))|50(4175|6699|67[0-7][0-9]|9000)|627780|63(6297|6368)|650(03([^4])|04([0-9])|05(0|1)|4(0[5-9]|3[0-9]|8[5-9]|9[0-9])|5([0-2][0-9]|3[0-8])|9([2-6][0-9]|7[0-8])|541|700|720|901)|651652|655000|655021)/,maxCardNumberLength:16,cvcLength:3},{type:"visa",format:t,startPattern:/^4/,maxCardNumberLength:19,cvcLength:3}],r=/(^[0-9]$|^(0[1-9]|10|11|12)$|^((0[1-9]|10|11|12)[0-9])$|^((0[1-9]|10|11|12)[0-9][0-9])$)/,n=["cardNumber","cvc","expiry"],a=function(t){return e.filter(function(e){return e.startPattern.test(t)})[0]},u=function(t,r){var n=function(t){return e.filter(function(e){return e.type===t})[0]}(t);return n?r>=n.cvcLength:r>=3},o=function(t){return/^[0-9]$/.test(t.key)},i=function(){return"Range"===window.getSelection().type},c=function(t){var e=t.e,n=t.inputType,a=e.key,u=e.target.value;(function(t){return!/^[a-zA-Z!@#\$%\^\&*\)\(+=._-]$/.test(t.key)})(e)&&("expiry"!==n||function(t,e){return!o({key:t})||r.test((""+e+t).replace("/",""))}(a,u)||i())||e.preventDefault()},f=function(t){var e=t.cardType,r=t.e,n=t.inputType,c=r.target.value;if(i()||!o(r))return null;if("cardNumber"===n)(function(t,e){var r=a(t);return r&&e>=r.maxCardNumberLength})(c,c.split(" ").join("").length)&&r.preventDefault();else if("expiry"===n){c.split("/").join("").length>=4&&r.preventDefault()}else if("cvc"===n){var f=c.length;u(e,f)&&r.preventDefault()}return null},p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return function(t){var e=t.cardType,r=t.inputType,u=t.selector;if(e&&"string"!=typeof e)throw new TypeError("Expected `cardType` to be a string, got "+(void 0===e?"undefined":p(e)));if("string"!=typeof r)throw new TypeError("Expected `inputType` to be a string, got "+(void 0===r?"undefined":p(r)));if("string"!=typeof u)throw new TypeError("Expected `selector` to be a string, got "+(void 0===u?"undefined":p(u)));if(!n.includes(r))throw new Error("Expected `inputType` to be "+n.join(",")+" - got "+r);var o=document.querySelector(u);return o.addEventListener("keypress",function(t){return t&&c({e:t,inputType:r})},!1),o.addEventListener("keypress",function(t){return t&&f({cardType:e,e:t,inputType:r})},!1),o.addEventListener("input",function(t){return t&&function(t){var e=t.e,r=t.element,n=t.inputType,u=t.value;if(!u)return null;if("cardNumber"===n){var o=a(u);o&&(r.value=function(t,e){if(e.global)return t.match(e).join(" ");var r=e.exec(t.split(" ").join(""));return r?r.splice(1,3).filter(function(t){return t}).join(" "):t}(u,o.format))}else"expiry"===n&&(r.value=function(t,e){if(!t)return null;var r=t;if(/^[2-9]$/.test(r)&&(r="0"+r),1===(r=r.match(/(\d{1,2})/g)).length){if(t.includes("/"))return r[0];if(/\d{2}/.test(r))return e.data?r[0]+"/":r[0]}return r.join("/")}(u,e));return null}({e:t,element:o,inputType:r,value:t.target.value})},!1),null}});
